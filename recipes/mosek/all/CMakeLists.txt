cmake_minimum_required(VERSION 3.15)
project(fusion64 CXX)

set(CMAKE_CXX_STANDARD 11 CACHE STRING "")
set(CMAKE_POSITION_INDEPENDENT_CODE ON CACHE BOOL "")
set(CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON)

include_directories(
    ${CMAKE_CURRENT_SOURCE_DIR}
    ${CMAKE_CURRENT_SOURCE_DIR}/../../h
)
link_directories(${CMAKE_CURRENT_SOURCE_DIR}/../../bin)

file(GLOB FUSION_SOURCES *.cc)
add_library(fusion64 ${FUSION_SOURCES})
set_target_properties(fusion64 PROPERTIES
    VERSION ${MOSEK_VERSION}
    SOVERSION ${MOSEK_VERSION}
    OUTPUT_NAME fusion64${DLL_SUFFIX}
)
target_link_libraries(fusion64 PRIVATE mosek64${DLL_SUFFIX})

include(GNUInstallDirs)
install(TARGETS fusion64
    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
)

install(DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/
        DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}
        FILES_MATCHING PATTERN *.h)
